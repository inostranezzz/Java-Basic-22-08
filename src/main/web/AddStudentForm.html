<!DOCTYPE  html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>Добавление студента</title>
    <link rel="stylesheet" href="universitystyles.css">
    <script>
        function addStudentInfo(){
            let studentsTab = document.getElementById("studentInfoTab").getElementsByTagName("tbody")[0];
            let fioText = document.getElementById("fioTextBox").value;
            let bornDate = document.getElementById("bornDate").value;
            let gender = document.getElementById("genderBox").value;

            if(isBlank(fioText)){
                alert("Безликие не учатся у Mr. Oizo");
                return;
            }

            if(isBlank(bornDate)){
                alert("Не имеющие даты рождения не учатся у Mr. Oizo");
                return;
            }

            if(Math.floor((new Date() - new Date(bornDate))/1000/3600/24/365) < "18"){
                alert("Не веселящиеся не учатся у Mr. Oizo");
                return;
            }

            let newRow = studentsTab.insertRow(studentsTab.rows.length);

            let fioCell = newRow.insertCell(0);
            fioCell.appendChild(document.createTextNode(fioText));

            let genderCell = newRow.insertCell(1);
            genderCell.appendChild(document.createTextNode(gender));

            let bornDateCell = newRow.insertCell(2);
            bornDateCell.appendChild(document.createTextNode(bornDate));

            let ageCell = newRow.insertCell(3);
            ageCell.appendChild(document.createTextNode(Math.floor((new Date() - new Date(bornDate))/1000/3600/24/365)));

           let sumMiddleAge = count = 0;
            for(let i = 0; i < studentsTab.rows.length; i++){
                sumMiddleAge += parseFloat(studentsTab.rows[i].getElementsByTagName("td")[3].innerHTML);
                count++;
            }
            let calcMiddleAge = sumMiddleAge/count;
            document.getElementById("middleAge").innerHTML = Math.ceil(calcMiddleAge);

            document.getElementById("fioTextBox").innerHTML = "";
            document.getElementById("bornDate").innerHTML = "";
        }

        function isBlank(str) {
            return (!str || /^\s*$/.test(str));
        }
    </script>
</head>
<body>
    <header class="border-header">
        <div class="logo">
            <a href="https://blog.12edit.ru/mr-oizo-flat-beat/" target = "_blank">
                <img src = "oizo.png" width = "200px" alt = "Mr. Oizo"/>
            </a>
        </div>
        <div class="header">
            <h2>Университет Mr. Oizo!!!</h2>
            <dl class="oblique">
                <dt>Мы это:</dt>
                    <dd>Молодость!</dd>
                    <dd>Веселье!</dd>
                    <dd>Команда!</dd>
            </dl>
            <p>18+</p>
        </div>
    </header>
    <div class="main">
        <div>
            <h2>Форма добавления информации о студенте</h2>
            <div class="input-block">
                <div class="input-section">
                    <label for = "fioTextBox">Имя студента:</label>
                    <input id = "fioTextBox" name = "fio" type="text" placeholder="Фамилия Имя Отчество"/>
                </div>
                <div class="input-section">
                    <label for = "bornDate">Дата рождения:</label>
                    <input id = "bornDate" name = "date" type = "date"/>
                </div>
                <div class="input-section">
                    <label>
                        Пол:
                        <select id = "genderBox" name="gender">
                            <option>мужчина</option>
                            <option>женщина</option>
                        </select>
                    </label>
                </div>
                <div class="input-section">
                    <button class="onclick" onclick="addStudentInfo()">Добавить</button>
                </div>
            </div>
        </div>
        <div>
            <h2>Таблица студентов</h2>
                <table class="statTab" id="studentInfoTab">
                        <thead>
                            <tr>
                                <td>Имя студента</td>
                                <td>Пол</td>
                                <td>Дата рождения</td>
                                <td>Возраст</td>
                            </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>Mr. Oizo</td>
                            <td>мужчина</td>
                            <td>01.01.1999</td>
                            <td>23</td>
                        </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4">&nbsp;</td>
                            </tr>
                            <tr>
                                <td colspan="3">Средний возраст студента</td>
                                <td id="middleAge">23</td>
                            </tr>
                        </tfoot>
                </table>
        </div>
    </div>
</body>
</html>